"use strict";!function(){function t(e){var t=e.getSelection(),a=t&&t.getRanges()[0];if(a){for(var n,r,o,l,s=t.createBookmarks(!1)[0],i=s.startNode,u=s.endNode||i,g=a.createIterator(),c=e.editable(),d=null,f=[];d=g.getNextParagraph();)f.push(d);e.getCommand("bootstrappackage_box").state==CKEDITOR.TRISTATE_OFF?(n=e,o=function(e,t){var a=null,n=null,r=[];for(;0<t.length;){for(n=t.shift();!n.getParent().equals(e);)n=n.getParent();n.equals(a)||(r.push(n),a=n)}return r}(function(e){for(var t=e[0].getParent(),a=null,n=0;n<e.length;n++)a=e[n],t=t.getCommonAncestor(a.getParent());var r={table:1,tbody:1,tr:1,ol:1,ul:1};for(;r[t.getName()];)t=t.getParent();return t}(r=f),r),l=function(e,t){var a=null,n=[];for(;0<t.length;)if("div"==(a=t.shift()).getName()&&a.hasClass("well")){for(var r=new CKEDITOR.dom.documentFragment(e.document);a.getFirst();)r.append(a.getFirst().remove()),n.push(r.getLast());r.replace(a)}else n.push(a);return n}(n,o),function(e,t){var a=e.document.createElement("div"),n=null;for(a.addClass("well"),a.insertBefore(t[0]);0<t.length;)n=t.shift(),a.append(n)}(n,l)):function(e){for(var t=null,a=e.length-1;0<=a;a--)m(t=e[a])&&t.remove()}(function(e){for(var t={},a=[],n=[],r=null,o=null,l=0;l<e.length;l++){r=e[l];var o=null,s=null;if("div"==r.getName()&&r.hasClass("well")&&m(r))a.push(r);else{for(;r.getParent();){if("div"==r.getParent().getName()&&r.getParent().hasClass("well")){o=r.getParent(),s=r;break}r=r.getParent()}o&&s&&!s.getCustomData("move")&&(n.push(s),CKEDITOR.dom.element.setMarker(t,s,"move",!0))}}for(CKEDITOR.dom.element.clearAllMarkers(t);0<n.length;)r=n.shift(),o=r.getParent(),r.getPrevious()?r.getNext()?(r.breakParent(r.getParent()),a.push(r.getNext())):r.remove().insertAfter(o):r.remove().insertBefore(o),o.getCustomData("processed")||(a.push(o),CKEDITOR.dom.element.setMarker(t,o,"processed",!0));return CKEDITOR.dom.element.clearAllMarkers(t),a}(f)),c.contains(i)&&c.contains(u)&&t.selectBookmarks([s]),e.focus()}}function a(e,t){var a=t.block||t.blockLimit,n=e.elementPath(a).contains(function(e){if(e.is("div")&&e.hasClass("well"))return!0},1);this.setState(n?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function m(e){for(var t,a=0,n=e.getChildCount();a<n&&(t=e.getChild(a));a++)if(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())return!1;return!0}CKEDITOR.plugins.add("bootstrappackage_box",{lang:"en,de",icons:"box",hidpi:!0,init:function(e){e.blockless||(e.addCommand("bootstrappackage_box",{exec:t,refresh:a,context:"div(well)",allowedContent:"div(!well)",requiredContent:"div(!well)"}),e.ui.addButton&&e.ui.addButton("Box",{label:e.lang.bootstrappackage_box.toolbar,command:"bootstrappackage_box",toolbar:"blocks"}))}})}();