"use strict";!function(){function t(e){var t=e.getSelection(),n=t&&t.getRanges()[0];if(n){for(var a=t.createBookmarks(!1)[0],r=a.startNode,o=a.endNode||r,l=n.createIterator(),s=e.editable(),i=null,u=[];i=l.getNextParagraph();)u.push(i);e.getCommand("bootstrappackage_box").state==CKEDITOR.TRISTATE_OFF?function(e,t){var n=function(e,t){var n=null,a=null,r=[];for(;0<t.length;){for(a=t.shift();!a.getParent().equals(e);)a=a.getParent();a.equals(n)||(r.push(a),n=a)}return r}(function(e){for(var t=e[0].getParent(),n=null,a=0;a<e.length;a++)n=e[a],t=t.getCommonAncestor(n.getParent());var r={table:1,tbody:1,tr:1,ol:1,ul:1};for(;r[t.getName()];)t=t.getParent();return t}(t),t),a=function(e,t){var n=null,a=[];for(;0<t.length;)if("div"==(n=t.shift()).getName()&&n.hasClass("well")){for(var r=new CKEDITOR.dom.documentFragment(e.document);n.getFirst();)r.append(n.getFirst().remove()),a.push(r.getLast());r.replace(n)}else a.push(n);return a}(e,n);!function(e,t){var n=e.document.createElement("div"),a=null;n.addClass("well"),n.insertBefore(t[0]);for(;0<t.length;)a=t.shift(),n.append(a)}(e,a)}(e,u):function(e,t){!function(e){for(var t=null,n=e.length-1;0<=n;n--)g(t=e[n])&&t.remove()}(function(e){for(var t={},n=[],a=[],r=null,o=null,l=0;l<e.length;l++){r=e[l];var o=null,s=null;if("div"==r.getName()&&r.hasClass("well")&&g(r))n.push(r);else{for(;r.getParent();){if("div"==r.getParent().getName()&&r.getParent().hasClass("well")){o=r.getParent(),s=r;break}r=r.getParent()}o&&s&&!s.getCustomData("move")&&(a.push(s),CKEDITOR.dom.element.setMarker(t,s,"move",!0))}}CKEDITOR.dom.element.clearAllMarkers(t);for(;0<a.length;)r=a.shift(),o=r.getParent(),r.getPrevious()?r.getNext()?(r.breakParent(r.getParent()),n.push(r.getNext())):r.remove().insertAfter(o):r.remove().insertBefore(o),o.getCustomData("processed")||(n.push(o),CKEDITOR.dom.element.setMarker(t,o,"processed",!0));return CKEDITOR.dom.element.clearAllMarkers(t),n}(t))}(0,u),s.contains(r)&&s.contains(o)&&t.selectBookmarks([a]),e.focus()}}function n(e,t){var n=t.block||t.blockLimit,a=e.elementPath(n).contains(function(e){if(e.is("div")&&e.hasClass("well"))return!0},1);this.setState(a?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function g(e){for(var t,n=0,a=e.getChildCount();n<a&&(t=e.getChild(n));n++)if(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())return!1;return!0}CKEDITOR.plugins.add("bootstrappackage_box",{lang:"en,de",icons:"box",hidpi:!0,init:function(e){e.blockless||(e.addCommand("bootstrappackage_box",{exec:t,refresh:n,context:"div(well)",allowedContent:"div(!well)",requiredContent:"div(!well)"}),e.ui.addButton&&e.ui.addButton("Box",{label:e.lang.bootstrappackage_box.toolbar,command:"bootstrappackage_box",toolbar:"blocks"}))}})}();