"use strict";!function(){function e(e){var t=e.getSelection(),n=t&&t.getRanges()[0];if(n){for(var r,o,l,s,i=t.createBookmarks(!1)[0],u=i.startNode,g=i.endNode||u,c=n.createIterator(),d=e.editable(),f=null,m=[];f=c.getNextParagraph();)m.push(f);e.getCommand("bootstrappackage_box").state==CKEDITOR.TRISTATE_OFF?(r=e,l=function(e,t){var a=null,n=null,r=[];for(;t.length>0;){for(n=t.shift();!n.getParent().equals(e);)n=n.getParent();n.equals(a)||(r.push(n),a=n)}return r}(function(e){for(var t=e[0].getParent(),a=null,n=0;n<e.length;n++)a=e[n],t=t.getCommonAncestor(a.getParent());var r={table:1,tbody:1,tr:1,ol:1,ul:1};for(;r[t.getName()];)t=t.getParent();return t}(o=m),o),s=function(e,t){var a=null,n=[];for(;t.length>0;)if("div"==(a=t.shift()).getName()&&a.hasClass("well")){for(var r=new CKEDITOR.dom.documentFragment(e.document);a.getFirst();)r.append(a.getFirst().remove()),n.push(r.getLast());r.replace(a)}else n.push(a);return n}(r,l),function(e,t){var a=e.document.createElement("div"),n=null;for(a.addClass("well"),a.insertBefore(t[0]);t.length>0;)n=t.shift(),a.append(n)}(r,s)):function(e){for(var t=null,n=e.length-1;n>=0;n--)a(t=e[n])&&t.remove()}(function(e){for(var t={},n=[],r=[],o=null,l=null,s=0;s<e.length;s++){var l=null,i=null;if("div"==(o=e[s]).getName()&&o.hasClass("well")&&a(o))n.push(o);else{for(;o.getParent();){if("div"==o.getParent().getName()&&o.getParent().hasClass("well")){l=o.getParent(),i=o;break}o=o.getParent()}l&&i&&!i.getCustomData("move")&&(r.push(i),CKEDITOR.dom.element.setMarker(t,i,"move",!0))}}for(CKEDITOR.dom.element.clearAllMarkers(t);r.length>0;)o=r.shift(),l=o.getParent(),o.getPrevious()?o.getNext()?(o.breakParent(o.getParent()),n.push(o.getNext())):o.remove().insertAfter(l):o.remove().insertBefore(l),l.getCustomData("processed")||(n.push(l),CKEDITOR.dom.element.setMarker(t,l,"processed",!0));return CKEDITOR.dom.element.clearAllMarkers(t),n}(m)),d.contains(u)&&d.contains(g)&&t.selectBookmarks([i]),e.focus()}}function t(e,t){var a=t.block||t.blockLimit,n=e.elementPath(a).contains(function(e){if(e.is("div")&&e.hasClass("well"))return!0},1);this.setState(n?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function a(e){for(var t,a=0,n=e.getChildCount();a<n&&(t=e.getChild(a));a++)if(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())return!1;return!0}CKEDITOR.plugins.add("bootstrappackage_box",{lang:"en,de",icons:"box",hidpi:!0,init:function(a){a.blockless||(a.addCommand("bootstrappackage_box",{exec:e,refresh:t,context:"div(well)",allowedContent:"div(!well)",requiredContent:"div(!well)"}),a.ui.addButton&&a.ui.addButton("Box",{label:a.lang.bootstrappackage_box.toolbar,command:"bootstrappackage_box",toolbar:"blocks"}))}})}();