"use strict";!function(){function e(e){var t=e.getSelection(),o=t&&t.getRanges()[0];if(o){for(var a,r,l,s,u=t.createBookmarks(!1)[0],c=u.startNode,i=u.endNode||c,m=o.createIterator(),g=e.editable(),d=null,f=[];d=m.getNextParagraph();)f.push(d);e.getCommand("bootstrappackage_columns").state==CKEDITOR.TRISTATE_OFF?(a=e,l=function(e,t){var n=null,o=null,a=[];for(;t.length>0;){for(o=t.shift();!o.getParent().equals(e);)o=o.getParent();o.equals(n)||(a.push(o),n=o)}return a}(function(e){for(var t=e[0].getParent(),n=null,o=0;o<e.length;o++)n=e[o],t=t.getCommonAncestor(n.getParent());var a={table:1,tbody:1,tr:1,ol:1,ul:1};for(;a[t.getName()];)t=t.getParent();return t}(r=f),r),s=function(e,t){var n=null,o=[];for(;t.length>0;)if("div"==(n=t.shift()).getName()&&n.hasClass("text-column")){for(var a=new CKEDITOR.dom.documentFragment(e.document);n.getFirst();)a.append(n.getFirst().remove()),o.push(a.getLast());a.replace(n)}else o.push(n);return o}(a,l),function(e,t){var n=e.document.createElement("div"),o=null;for(n.addClass("text-column"),n.insertBefore(t[0]);t.length>0;)o=t.shift(),n.append(o)}(a,s)):function(e){for(var t=null,o=e.length-1;o>=0;o--)n(t=e[o])&&t.remove()}(function(e){for(var t={},o=[],a=[],r=null,l=null,s=0;s<e.length;s++){var l=null,u=null;if("div"==(r=e[s]).getName()&&r.hasClass("text-column")&&n(r))o.push(r);else{for(;r.getParent();){if("div"==r.getParent().getName()&&r.getParent().hasClass("text-column")){l=r.getParent(),u=r;break}r=r.getParent()}l&&u&&!u.getCustomData("move")&&(a.push(u),CKEDITOR.dom.element.setMarker(t,u,"move",!0))}}for(CKEDITOR.dom.element.clearAllMarkers(t);a.length>0;)r=a.shift(),l=r.getParent(),r.getPrevious()?r.getNext()?(r.breakParent(r.getParent()),o.push(r.getNext())):r.remove().insertAfter(l):r.remove().insertBefore(l),l.getCustomData("processed")||(o.push(l),CKEDITOR.dom.element.setMarker(t,l,"processed",!0));return CKEDITOR.dom.element.clearAllMarkers(t),o}(f)),g.contains(c)&&g.contains(i)&&t.selectBookmarks([u]),e.focus()}}function t(e,t){var n=t.block||t.blockLimit,o=e.elementPath(n).contains(function(e){if(e.is("div")&&e.hasClass("text-column"))return!0},1);this.setState(o?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function n(e){for(var t,n=0,o=e.getChildCount();n<o&&(t=e.getChild(n));n++)if(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())return!1;return!0}CKEDITOR.plugins.add("bootstrappackage_columns",{lang:"en,de",icons:"columns",hidpi:!0,init:function(n){n.blockless||(n.addCommand("bootstrappackage_columns",{exec:e,refresh:t,context:"div(text-column)",allowedContent:"div(!text-column)",requiredContent:"div(!text-column)"}),n.ui.addButton&&n.ui.addButton("Columns",{label:n.lang.bootstrappackage_columns.toolbar,command:"bootstrappackage_columns",toolbar:"blocks"}))}})}();