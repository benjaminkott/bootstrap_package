"use strict";!function(){function t(e){var t=e.getSelection(),n=t&&t.getRanges()[0];if(n){for(var o,a,r,l,s=t.createBookmarks(!1)[0],u=s.startNode,c=s.endNode||u,i=n.createIterator(),m=e.editable(),g=null,d=[];g=i.getNextParagraph();)d.push(g);e.getCommand("bootstrappackage_columns").state==CKEDITOR.TRISTATE_OFF?(o=e,r=function(e,t){var n=null,o=null,a=[];for(;0<t.length;){for(o=t.shift();!o.getParent().equals(e);)o=o.getParent();o.equals(n)||(a.push(o),n=o)}return a}(function(e){for(var t=e[0].getParent(),n=null,o=0;o<e.length;o++)n=e[o],t=t.getCommonAncestor(n.getParent());var a={table:1,tbody:1,tr:1,ol:1,ul:1};for(;a[t.getName()];)t=t.getParent();return t}(a=d),a),l=function(e,t){var n=null,o=[];for(;0<t.length;)if("div"==(n=t.shift()).getName()&&n.hasClass("text-column")){for(var a=new CKEDITOR.dom.documentFragment(e.document);n.getFirst();)a.append(n.getFirst().remove()),o.push(a.getLast());a.replace(n)}else o.push(n);return o}(o,r),function(e,t){var n=e.document.createElement("div"),o=null;for(n.addClass("text-column"),n.insertBefore(t[0]);0<t.length;)o=t.shift(),n.append(o)}(o,l)):function(e){for(var t=null,n=e.length-1;0<=n;n--)f(t=e[n])&&t.remove()}(function(e){for(var t={},n=[],o=[],a=null,r=null,l=0;l<e.length;l++){a=e[l];var r=null,s=null;if("div"==a.getName()&&a.hasClass("text-column")&&f(a))n.push(a);else{for(;a.getParent();){if("div"==a.getParent().getName()&&a.getParent().hasClass("text-column")){r=a.getParent(),s=a;break}a=a.getParent()}r&&s&&!s.getCustomData("move")&&(o.push(s),CKEDITOR.dom.element.setMarker(t,s,"move",!0))}}for(CKEDITOR.dom.element.clearAllMarkers(t);0<o.length;)a=o.shift(),r=a.getParent(),a.getPrevious()?a.getNext()?(a.breakParent(a.getParent()),n.push(a.getNext())):a.remove().insertAfter(r):a.remove().insertBefore(r),r.getCustomData("processed")||(n.push(r),CKEDITOR.dom.element.setMarker(t,r,"processed",!0));return CKEDITOR.dom.element.clearAllMarkers(t),n}(d)),m.contains(u)&&m.contains(c)&&t.selectBookmarks([s]),e.focus()}}function n(e,t){var n=t.block||t.blockLimit,o=e.elementPath(n).contains(function(e){if(e.is("div")&&e.hasClass("text-column"))return!0},1);this.setState(o?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function f(e){for(var t,n=0,o=e.getChildCount();n<o&&(t=e.getChild(n));n++)if(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())return!1;return!0}CKEDITOR.plugins.add("bootstrappackage_columns",{lang:"en,de",icons:"columns",hidpi:!0,init:function(e){e.blockless||(e.addCommand("bootstrappackage_columns",{exec:t,refresh:n,context:"div(text-column)",allowedContent:"div(!text-column)",requiredContent:"div(!text-column)"}),e.ui.addButton&&e.ui.addButton("Columns",{label:e.lang.bootstrappackage_columns.toolbar,command:"bootstrappackage_columns",toolbar:"blocks"}))}})}();