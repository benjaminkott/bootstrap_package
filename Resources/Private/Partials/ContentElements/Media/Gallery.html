{namespace bk2k = BK2K\BootstrapPackage\ViewHelpers}
<f:if condition="{files}">
    <bk2k:imageSize>
        <f:switch expression="{data.image_rendering}">

            <f:case value="4">
                <f:render section="LayoutCss" arguments="{files: files, data: data, settings: settings, imagesize: imagesize}" />
            </f:case>


            <f:case value="64">
                <f:comment>Bypass link wrapper arround images</f:comment>

                <f:comment>Resize images according frames</f:comment>
                <f:switch expression="{data.section_frame}">

                    <f:case value="10">
                        <f:comment>indent 1 width 10</f:comment>
                        <bk2k:imageSize xs="10"/>
                    </f:case>

                    <f:case value="11">
                        <f:comment>indent 3 right</f:comment>
                        <bk2k:imageSize xs="9"/>
                    </f:case>

                    <f:case value="12">
                        <f:comment>indent 3 left</f:comment>
                        <bk2k:imageSize xs="9"/>
                    </f:case>

                    <f:case value="20">
                        <f:comment>well</f:comment>
                        <bk2k:imageSize marginxs="20"/>
                    </f:case>

                    <f:case value="21">
                        <f:comment>jumbotron</f:comment>
                        <bk2k:imageSize marginxs="20" marginsm="60"/>
                    </f:case>

                </f:switch>

                <f:render section="LayoutNoLink" arguments="{files: files, data: data, settings: settings, imagesize: imagesize}" />

            </f:case>


            <f:case value="78">
                <f:comment>Lightbox link only</f:comment>
                <f:render section="Type" arguments="{file: files, data: data, settings: settings, imagesize: imagesize}" />
            </f:case>


            <f:case default="TRUE">

                <f:comment>Resize images according frames</f:comment>
                <f:switch expression="{data.section_frame}">

                    <f:case value="10">
                        <f:comment>indent 1 width 10</f:comment>
                        <bk2k:imageSize xs="10"/>
                    </f:case>

                    <f:case value="11">
                        <f:comment>indent 3 right</f:comment>
                        <bk2k:imageSize xs="9"/>
                    </f:case>

                    <f:case value="12">
                        <f:comment>indent 3 left</f:comment>
                        <bk2k:imageSize xs="9"/>
                    </f:case>

                    <f:case value="20">
                        <f:comment>well</f:comment>
                        <bk2k:imageSize marginxs="20"/>
                    </f:case>

                    <f:case value="21">
                        <f:comment>jumbotron</f:comment>
                        <bk2k:imageSize marginxs="20" marginsm="60"/>
                    </f:case>

                </f:switch>

                <f:switch expression="{bk2k:simpleMath(operator: '&', a:'3', b: '{data.images_layout}')}">

                    <f:case value="1">
                        <f:render section="LayoutNoRows" arguments="{files: files, data: data, settings: settings, imagesize: imagesize}" />
                    </f:case>

                    <f:case value="2">
                        <f:render section="LayoutNoCols" arguments="{files: files, data: data, settings: settings, imagesize: imagesize}" />
                    </f:case>

                    <f:case default="TRUE">
                        <f:render section="LayoutFixed" arguments="{files: files, data: data, settings: settings, imagesize: imagesize}" />
                    </f:case>

                </f:switch>
            </f:case>

        </f:switch>
    </bk2k:imageSize>
</f:if>



<f:comment>Css</f:comment>
<f:section name="LayoutCss">
    <bk2k:imagesLayout files="{files}" data="{data}" settings="{settings}" imagesize="imagesize" as="collection">
        <bk2k:css inline="{settings.moveCssToBody}">
            <f:for each="{collection.files}" as="file" iteration="fileIteration">
                <f:render section="Type" arguments="{file: file.srcset, data: data, settings: settings, imagesize: file.size}" />
            </f:for>
        </bk2k:css>
    </bk2k:imagesLayout>
</f:section>



<f:comment>Bypass link</f:comment>
<f:section name="LayoutNoLink">
    <bk2k:imagesLayout files="{files}" data="{data}" settings="{settings}" imagesize="imagesize" as="collection">

        <f:if condition="{settings.images.preventrelayout}">
            <f:render section="PreventRelayoutByCss" arguments="{collection: collection, settings: settings}" />
        </f:if>
        <f:for each="{collection.files}" as="file" iteration="fileIteration">
            <f:render section="Type" arguments="{file: file.srcset, data: data, settings: settings, imagesize: file.size}" />
        </f:for>

    </bk2k:imagesLayout>
</f:section>



<f:comment>
    on fluid layout,  the width of images depends on layout and is 100% of parent, so we only set padding.
    on fixed layouts, the width of images should explicitly be set.
    breakpoint 3 = xs
    breakpoint 2 = sm
    breakpoint 1 = md
    breakpoint 0 = lg
</f:comment>
<f:comment>Use css to prevent relayout</f:comment>
<f:section name="PreventRelayoutByCss">
    <bk2k:css inline="{settings.moveCssToBody}">

        <bk2k:mediaQuery min="lg">
            <f:for each="{collection.files}" as="file" iteration="fileIteration">
                #{file.size.selector}<f:format.raw>{</f:format.raw>padding-bottom:{file.size.lg.padding}%;
                <f:if condition="{settings.images.breakpoint} > 0">
                    width:{file.size.lg.width}px;
                </f:if>
                <f:format.raw>}</f:format.raw>
            </f:for>
        </bk2k:mediaQuery>

        <bk2k:mediaQuery min="md" max="lg">
            <f:for each="{collection.files}" as="file" iteration="fileIteration">
                #{file.size.selector}<f:format.raw>{</f:format.raw>padding-bottom:{file.size.md.padding}%;
                <f:if condition="{settings.images.breakpoint} > 1">
                    width:{file.size.md.width}px;
                </f:if>
                <f:format.raw>}</f:format.raw>
            </f:for>
        </bk2k:mediaQuery>

        <bk2k:mediaQuery min="sm" max="md">
            <f:for each="{collection.files}" as="file" iteration="fileIteration">
                #{file.size.selector}<f:format.raw>{</f:format.raw>padding-bottom:{file.size.sm.padding}%;
                <f:if condition="{settings.images.breakpoint} > 2">
                    width:{file.size.sm.width}px;
                </f:if>
                <f:format.raw>}</f:format.raw>
            </f:for>
        </bk2k:mediaQuery>

        <bk2k:mediaQuery min="xs" max="sm">
            <f:for each="{collection.files}" as="file" iteration="fileIteration">
                #{file.size.selector}<f:format.raw>{</f:format.raw>padding-bottom:{file.size.xs.padding}%;
                <f:if condition="{settings.images.breakpoint} > 3">
                    width:{file.size.xs.width}px;
                </f:if>
                <f:format.raw>}</f:format.raw>
            </f:for>
        </bk2k:mediaQuery>
        <bk2k:mediaQuery max="xs">
            <f:for each="{collection.files}" as="file" iteration="fileIteration">
                #{file.size.selector}<f:format.raw>{</f:format.raw>padding-bottom:{file.size.xxs.padding}%;
                <f:if condition="{settings.images.breakpoint} > 4">
                    width:{file.size.xxs.width}px;
                </f:if>
                <f:format.raw>}</f:format.raw>
            </f:for>
        </bk2k:mediaQuery>
    </bk2k:css>
</f:section>



<f:comment>Equal height for each row, flexible width</f:comment>
<f:section name="LayoutNoRows">

    <bk2k:imagesLayout files="{files}" data="{data}" settings="{settings}" imagesize="imagesize" as="collection">

        <f:if condition="{settings.images.preventrelayout}">
            <f:render section="PreventRelayoutByCss" arguments="{collection: collection, settings: settings}" />
        </f:if>

        <f:switch expression="{data.images_layout}">
            <f:case value="17">
                <bk2k:var name="class" value="col-flex col-flex-top"/>
            </f:case>
            <f:case value="33">
                <bk2k:var name="class" value="col-flex col-flex-bottom"/>
            </f:case>
            <f:case default="TRUE">
                <bk2k:var name="class" value="col-flex"/>
            </f:case>
        </f:switch>

        <bk2k:css inline="{settings.moveCssToBody}" key="bootstrap_package_colums-{data.uid}">
            #row-{data.uid} > .col-flex<f:format.raw>{</f:format.raw>width:{collection.colpercent}%;<f:format.raw>}</f:format.raw>
        </bk2k:css>

        <div class="row-flex" id="row-{data.uid}">
            <div class="{class}">
                <f:for each="{collection.files}" as="file" iteration="fileIteration">

                    <f:render section="Type" arguments="{file: file.srcset, data: data, settings: settings, imagesize: file.size}" />

                    <f:if condition="{fileIteration.index} > 0">
                        <f:if condition="{fileIteration.cycle} < {fileIteration.total}">
                            <f:if condition="{bk2k:simpleMath(a:'{fileIteration.cycle}', b:'{collection.imagecols}', operator:'%')} < 0.1">
                                </div><div class="{class}">
                            </f:if>
                        </f:if>
                    </f:if>
                </f:for>
            </div>
        </div>

    </bk2k:imagesLayout>

</f:section>



<f:comment>Equal width for each columns, flexible height</f:comment>
<f:section name="LayoutNoCols">

    <bk2k:imagesLayout files="{files}" data="{data}" settings="{settings}" imagesize="imagesize" as="collection">

        <f:if condition="{settings.images.preventrelayout}">
            <f:render section="PreventRelayoutByCss" arguments="{collection: collection, settings: settings}" />
        </f:if>

        <f:switch expression="{data.images_layout}">
            <f:case value="34">
                <bk2k:var name="class" value="row-flex row-flex-right"/>
            </f:case>
            <f:case value="18">
                <bk2k:var name="class" value="row-flex row-flex-left"/>
            </f:case>
            <f:case default="TRUE">
                <bk2k:var name="class" value="row-flex"/>
            </f:case>
        </f:switch>

        <bk2k:css inline="{settings.moveCssToBody}" key="bootstrap_package_row-justify-{data.uid}">

            <f:comment>
                when fluid, the layout should be set so images resize according.
                when fixed, the width of columns depends on images.
                lg = 0
                md = 1
                sm = 2
                xs = 3
                xxs = 4
            </f:comment>

            <f:if condition="{settings.images.breakpoint} < 5">
                <bk2k:mediaQuery max="xs">
                    <f:for each="{collection.files}" as="file" iteration="fileIteration">
                        #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.xxs.percent}%<f:format.raw>;}</f:format.raw>
                    </f:for>
                </bk2k:mediaQuery>
            </f:if>
            <f:if condition="{settings.images.breakpoint} < 4">
                <bk2k:mediaQuery min="xs" max="sm">
                    <f:for each="{collection.files}" as="file" iteration="fileIteration">
                        #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.xs.percent}%<f:format.raw>;}</f:format.raw>
                    </f:for>
                </bk2k:mediaQuery>
            </f:if>
            <f:if condition="{settings.images.breakpoint} < 3">
                <bk2k:mediaQuery min="sm" max="md">
                    <f:for each="{collection.files}" as="file" iteration="fileIteration">
                        #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.sm.percent}%<f:format.raw>;}</f:format.raw>
                    </f:for>
                </bk2k:mediaQuery>
            </f:if>
            <f:if condition="{settings.images.breakpoint} < 2">
                <bk2k:mediaQuery min="md" max="lg">
                    <f:for each="{collection.files}" as="file" iteration="fileIteration">
                        #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.md.percent}%<f:format.raw>;}</f:format.raw>
                    </f:for>
                </bk2k:mediaQuery>
            </f:if>
            <f:if condition="{settings.images.breakpoint} < 1">
                <bk2k:mediaQuery min="lg">
                    <f:for each="{collection.files}" as="file" iteration="fileIteration">
                        #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.lg.percent}%<f:format.raw>;}</f:format.raw>
                    </f:for>
                </bk2k:mediaQuery>
            </f:if>
        </bk2k:css>

        <div class="{class}">
            <f:for each="{collection.files}" as="file" iteration="fileIteration">

                <div id="col-{data.uid}-{fileIteration.cycle}" class="col-flex">
                    <f:render section="Type" arguments="{file: file.srcset, data: data, settings: settings, imagesize: file.size}" />
                </div>

                <f:if condition="{fileIteration.cycle} > 0">
                    <f:if condition="{fileIteration.cycle} < {fileIteration.total}">
                        <f:if condition="{bk2k:simpleMath(operator: '%', a:'{fileIteration.cycle}', b:'{collection.imagecols}')} == 0">
                            </div><div class="{class}">
                        </f:if>
                    </f:if>
                </f:if>
            </f:for>
        </div>
    </bk2k:imagesLayout>
</f:section>



<f:comment>Regular grid layout with variable columns count</f:comment>
<f:section name="LayoutFixed">
    <bk2k:var name="columns" value="{bk2k:simpleMath( operator:'min', a:'{data.imagecols}', b:'{files->f:count()}')}" />

    <f:switch expression="{columns}">

        <f:case value="2">
            <bk2k:imageSize store="1" xs="12" sm="6"/>
            <bk2k:var name="class" value="col-sm-6" />
        </f:case>

        <f:case value="3">
            <bk2k:imageSize store="1" xs="4"/>
            <bk2k:var name="class" value="col-xs-4" />
        </f:case>

        <f:case value="4">
            <bk2k:imageSize store="1" xs="6" sm="3"/>
            <bk2k:var name="class" value="col-xs-6 col-sm-3" />
        </f:case>

        <f:case value="5">
            <bk2k:imageSize store="1" xs="4" sm="2.4" />
            <bk2k:var name="class" value="col-xs-4 col-sm-1-5" />
        </f:case>

        <f:case value="6">
            <bk2k:imageSize store="1" xs="4" md="2"/>
            <bk2k:var name="class" value="col-xs-4 col-md-2" />
        </f:case>

        <f:case value="7">
            <bk2k:imageSize store="1" xs="4" sm="3" md="1.7142857142857142857142857142857" />
            <bk2k:var name="class" value="col-xs-4 col-sm-3 col-md-1-7" />
        </f:case>

        <f:case value="8">
            <bk2k:imageSize store="1" xs="4" sm="3" md="1.5" />
            <bk2k:var name="class" value="col-xs-4 col-sm-3 col-md-1-8" />
        </f:case>

        <f:case value="9">
            <bk2k:imageSize store="1" xs="4" sm="4" md="1.333333333333333333333333333333" />
            <bk2k:var name="class" value="col-xs-4 col-sm-4 col-md-1-9" />
        </f:case>

        <f:case value="10">
            <bk2k:imageSize store="1" xs="4" sm="2.4" md="1.2" />
            <bk2k:var name="class" value="col-xs-4 col-sm-1-5 col-md-1-10" />
        </f:case>

        <f:case default="TRUE">
            <bk2k:imageSize store="1" xs="12" />
            <bk2k:var name="class" value="col-xs-12" />
        </f:case>

    </f:switch>

    <bk2k:imagesLayout files="{files}" data="{data}" settings="{settings}" imagesize="imagesize" as="collection">

        <f:if condition="{settings.images.preventrelayout}">
            <f:render section="PreventRelayoutByCss" arguments="{collection: collection, settings: settings}" />
        </f:if>

        <div class="row gutter-flex">

            <f:for each="{collection.files}" as="file" iteration="fileIteration">

                <div class="{class}">
                    <f:render section="Type" arguments="{file: file.srcset, data: data, settings: settings, imagesize: file.size}" />
                </div>

                <f:comment>Reset for columns / lines (replace equalheight.js by markup)</f:comment>

                <f:if condition="{fileIteration.cycle} < {fileIteration.total}">
                    <f:if condition="{bk2k:simpleMath(a:'{fileIteration.cycle}', b:'{collection.cols.xs}', operator:'%')} < 0.1">
                        <div class="clearfix visible-xs-block"></div>
                    </f:if>
                    <f:if condition="{bk2k:simpleMath(a:'{fileIteration.cycle}', b:'{collection.cols.sm}', operator:'%')} < 0.1">
                        <div class="clearfix visible-sm-block"></div>
                    </f:if>
                    <f:if condition="{bk2k:simpleMath(a:'{fileIteration.cycle}', b:'{collection.cols.md}', operator:'%')} < 0.1">
                        <div class="clearfix visible-md-block"></div>
                    </f:if>
                    <f:if condition="{bk2k:simpleMath(a:'{fileIteration.cycle}', b:'{collection.cols.lg}', operator:'%')} < 0.1">
                        <div class="clearfix visible-lg-block"></div>
                    </f:if>
                </f:if>

            </f:for>

        </div>

    </bk2k:imagesLayout>

</f:section>



<f:comment>
    FILETYPE_UNKNOWN = 0;
    FILETYPE_TEXT = 1;
    FILETYPE_IMAGE = 2;
    FILETYPE_AUDIO = 3;
    FILETYPE_VIDEO = 4;
    FILETYPE_APPLICATION = 5;
</f:comment>
<f:comment>Media type</f:comment>
<f:section name="Type">
    <f:switch expression="{file.0.type}">

        <f:case value="2">

            <f:switch expression="{data.image_rendering}">

                <f:case value="4">
                    <f:comment>rendering css</f:comment>
                    <f:render section="ImageTagType" arguments="{file: file, data: data, settings: settings, imagesize: imagesize}" />
                </f:case>

                <f:case value="47">
                    <f:render section="LightboxLink" arguments="{file: file, data: data, settings: settings, imagesize: imagesize}" />
                </f:case>

                <f:case value="64">
                    <f:comment>rendering method without any link for thumbs menuItems / media list</f:comment>
                    <f:render section="ImageTagType" arguments="{file: file, data: data, settings: settings, imagesize: imagesize}" />
                </f:case>

                <f:case default="TRUE">
                    <f:render section="Image" arguments="{file: file, data: data, settings: settings, imagesize: imagesize}" />
                </f:case>

            </f:switch>

        </f:case>

        <f:case value="3">
            <f:comment>Audio files</f:comment>
            <f:render section="Fallback" arguments="{file: file.0, data: data, settings: settings, imagesize: imagesize}" />
        </f:case>

        <f:case value="4">
            <f:render section="Video" arguments="{file: file.0, data: data, imagesize: imagesize, settings: settings}" />
        </f:case>

        <f:case value="5">
            <f:switch expression="{data.image_rendering}">

                <f:case value="64">
                    <f:comment>rendering method without any link for thumbs menuItems / media list</f:comment>
                    <f:render section="ImageTagType" arguments="{file: file, data: data, settings: settings, imagesize: imagesize}" />
                </f:case>

                <f:case default="TRUE">
                    <f:render section="Image" arguments="{file: file, data: data, settings: settings, imagesize: imagesize}" />
                </f:case>

            </f:switch>
        </f:case>

        <f:case default="TRUE">

            <f:comment>Unknown file type</f:comment>
            <f:render section="Fallback" arguments="{file: file.0, data: data, settings: settings, imagesize: imagesize}" />
        </f:case>
    </f:switch>
</f:section>



<f:comment>Media type image</f:comment>
<f:section name="Image">
    <figure class="image">
        <f:if condition="{file.0.link}">
            <f:then>
                <f:link.typolink parameter="{file.0.link}" title="{file.0.title}">
                    <f:render section="ImageTagType" arguments="{file: file, settings: settings, imagesize: imagesize}" />
                </f:link.typolink>
            </f:then>
            <f:else>
                <f:if condition="{data.image_zoom}">
                    <f:then>
                        <a href="{f:uri.image(image: file.0, maxHeight: '1200', maxWidth: '1200')}" title="{file.0.title}" class="{settings.lightbox.cssClass}" data-lightbox-width="{bk2k:lastImageInfo(property: 'width')}" data-lightbox-height="{bk2k:lastImageInfo(property: 'height')}" rel="{settings.lightbox.prefix}-{data.uid}">
                            <f:render section="ImageTagType" arguments="{file: file, settings: settings, imagesize: imagesize}" />
                        </a>
                    </f:then>
                    <f:else>
                        <f:render section="ImageTagType" arguments="{file: file, settings: settings, imagesize: imagesize}" />
                    </f:else>
                </f:if>
            </f:else>
        </f:if>
        <f:if condition="{f:if(condition:'{imagesize.globalcaption}', then:'0', else:'{file.0.description}')}">
            <figcaption class="caption">
                {file.0.description}
            </figcaption>
        </f:if>
    </figure>
</f:section>



<f:comment>Media type video</f:comment>
<f:section name="Video">
    <figure class="image">
        <div class="embed-responsive embed-responsive-16by9">
            <f:render section="RenderingVideo" arguments="{file: file, settings: settings}" />
        </div>
        <f:if condition="{file.description}">
            <figcaption class="caption">
                {file.description}
            </figcaption>
        </f:if>
    </figure>
</f:section>



<f:comment>Media type LightboxLink</f:comment>
<f:section name="LightboxLink">
    <a href="{f:uri.image(image: file.0, maxHeight: '1200', maxWidth: '1200')}" title="{file.0.title}" class="{settings.lightbox.cssClass}" data-lightbox-width="{bk2k:lastImageInfo(property: 'width')}" data-lightbox-height="{bk2k:lastImageInfo(property: 'height')}" rel="{settings.lightbox.prefix}-{data.uid}">
        {file.0.description}
    </a>
</f:section>



<f:comment>Media type unknown</f:comment>
<f:section name="Fallback">
    <figure class="image">
        <div>
            <f:render section="RenderingFallback" arguments="{file: file.0, settings: settings}" />
        </div>
        <f:if condition="{file.description}">
            <figcaption class="caption">
                {file.description}
            </figcaption>
        </f:if>
    </figure>
</f:section>



<f:comment>Img tag type</f:comment>
<f:section name="ImageTagType">
    <bk2k:var name="tag" value="{bk2k:simpleMath( operator: '&', a:'{data.image_rendering}', b:'15')}" />
    <f:switch expression="{f:if(condition: '{tag}', then:'{tag}', else:'{settings.images.tag}')}">

        <f:case value="2">
            <f:render section="RenderingPicture" arguments="{file: file, data:data, settings: settings, imagesize: imagesize}" />
        </f:case>

        <f:case value="3">
            <f:render section="RenderingImgSrcset" arguments="{file: file, data:data, settings: settings, imagesize: imagesize}" />
        </f:case>

        <f:case value="4">
            <f:render section="RenderingCss" arguments="{file: file, data: data, settings: settings, imagesize: imagesize}" />
        </f:case>

        <f:case default="TRUE">
            <f:render section="RenderingImg" arguments="{file: file, data: data, settings: settings, imagesize: imagesize}" />
        </f:case>

    </f:switch>
</f:section>



<f:comment>Image tag Picture</f:comment>
<f:section name="RenderingPicture">
    <div id="{imagesize.selector}" {f:if(condition: '{settings.images.preventrelayout}', then: 'class="embed-responsive"')}>
        <picture>
            <source media="{bk2k:mediaQuery( min:'lg', short:'1')}" {f:if(condition:'{imagesize.lg.type}', then:'type="{imagesize.lg.type}"')} {f:if(condition:'{settings.images.lazyload}', then:'data-')}srcset="{f:uri.image(image: file.0, width: '{imagesize.lg.width}{imagesize.lg.cropwidth}', height: '{imagesize.lg.height}{imagesize.lg.cropheight}', absolute: '{settings.images.absoluteUrl}')}" />
            <source media="{bk2k:mediaQuery( min:'md', short:'1')}" {f:if(condition:'{imagesize.md.type}', then:'type="{imagesize.md.type}"')} {f:if(condition:'{settings.images.lazyload}', then:'data-')}srcset="{f:uri.image(image: file.1, width: '{imagesize.md.width}{imagesize.md.cropwidth}', height: '{imagesize.md.height}{imagesize.md.cropheight}', absolute: '{settings.images.absoluteUrl}')}" />
            <source media="{bk2k:mediaQuery( min:'sm', short:'1')}" {f:if(condition:'{imagesize.sm.type}', then:'type="{imagesize.sm.type}"')} {f:if(condition:'{settings.images.lazyload}', then:'data-')}srcset="{f:uri.image(image: file.2, width: '{imagesize.sm.width}{imagesize.sm.cropwidth}', height: '{imagesize.sm.height}{imagesize.sm.cropheight}', absolute: '{settings.images.absoluteUrl}')}" />
            <source media="{bk2k:mediaQuery( min:'xs', short:'1')}" {f:if(condition:'{imagesize.xs.type}', then:'type="{imagesize.xs.type}"')} {f:if(condition:'{settings.images.lazyload}', then:'data-')}srcset="{f:uri.image(image: file.3, width: '{imagesize.xs.width}{imagesize.xs.cropwidth}', height: '{imagesize.xs.height}{imagesize.xs.cropheight}', absolute: '{settings.images.absoluteUrl}')}" />
            <source {f:if(condition:'{imagesize.xxs.type}', then:'type="{imagesize.xxs.type}"')} {f:if(condition:'{settings.images.lazyload}', then:'data-')}srcset="{f:uri.image(image: file.4, width: '{imagesize.xxs.width}{imagesize.xxs.cropwidth}', height: '{imagesize.xxs.height}{imagesize.xxs.cropheight}', absolute: '{settings.images.absoluteUrl}')}" />
            <img {f:if(condition:'{settings.images.lazyload}', then:'class="lazyload" data-')}src="{f:uri.image(image: file.0, width: '{imagesize.lg.width}{imagesize.lg.cropwidth}', height: '{imagesize.lg.height}{imagesize.lg.cropheight}', absolute: '{settings.images.absoluteUrl}')}"
             title="{file.0.title}"
             alt="{file.0.alternative}"
            />
        </picture>
    </div>
</f:section>



<f:comment>Image tag Img srcset</f:comment>
<f:section name="RenderingImgSrcset">
    <div id="{imagesize.selector}" {f:if(condition: '{settings.images.preventrelayout}', then: 'class="embed-responsive"')}>
        <img {f:if(condition: '{settings.images.lazyload}', then: 'class="lazyload" ')}
        sizes="{bk2k:mediaQuery(short: '1', min: 'lg')} {imagesize.lg.width}px,
        {bk2k:mediaQuery(short: '1', min: 'md', max: 'lg')} {imagesize.md.width}px,
        {bk2k:mediaQuery(short: '1', min: 'sm', max: 'md')} {imagesize.sm.width}px,
        {bk2k:mediaQuery(short: '1', min: 'xs', max: 'sm')} {imagesize.xs.width}px,
        {imagesize.xxs.width}px"
        {f:if(condition: '{settings.images.lazyload}', then: 'data-')}srcset="{f:uri.image(image: file.0, width: '{imagesize.lg.width}{imagesize.lg.cropwidth}', height: '{imagesize.lg.height}{imagesize.lg.cropheight}', absolute: '{settings.images.absoluteUrl}')} {imagesize.lg.width}w,
        {f:uri.image(image: file.1, width: '{imagesize.md.width}{imagesize.md.cropwidth}', height: '{imagesize.md.height}{imagesize.md.cropheight}', absolute: '{settings.images.absoluteUrl}')} {imagesize.md.width}w,
        {f:uri.image(image: file.2, width: '{imagesize.sm.width}{imagesize.sm.cropwidth}', height: '{imagesize.sm.height}{imagesize.sm.cropheight}', absolute: '{settings.images.absoluteUrl}')} {imagesize.sm.width}w,
        {f:uri.image(image: file.3, width: '{imagesize.xs.width}{imagesize.xs.cropwidth}', height: '{imagesize.xs.height}{imagesize.xs.cropheight}', absolute: '{settings.images.absoluteUrl}')} {imagesize.xs.width}w,
        {f:uri.image(image: file.4, width: '{imagesize.xxs.width}{imagesize.xxs.cropwidth}', height: '{imagesize.xxs.height}{imagesize.xxs.cropheight}', absolute: '{settings.images.absoluteUrl}')} {imagesize.xxs.width}w"
        <f:if condition="{settings.images.lazyload}">
            <f:then>
                data-src="{f:uri.image(image: file.0, absolute: '{settings.images.absoluteUrl}')}"
                <f:switch expression="{settings.images.placeholder}">
                    <f:case value="1">
                        src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
                    </f:case>
                    <f:case value="2">
                        src="{f:uri.image(image: file.0, width: '{imagesize.placeholder.width}{imagesize.lg.cropwidth}', height: '{imagesize.placeholder.height}{imagesize.lg.cropheight}', absolute: '{settings.images.absoluteUrl}')}"
                    </f:case>
                    <f:case default="TRUE">
                        src="{f:uri.image(src: 'EXT:bootstrap_package/Resources/Public/Images/blank.gif')}"
                    </f:case>
                </f:switch>
            </f:then>
            <f:else>
                src="{f:uri.image(image: file.0, absolute: '{settings.images.absoluteUrl}')}"
            </f:else>
        </f:if>
        title="{file.0.title}"
        alt="{file.0.alternative}"
        />
        <noscript>
            <img src="{f:uri.image(image: file.0, absolute: '{settings.images.absoluteUrl}')}" title="{file.0.title}" alt="{file.0.alternative}" />
        </noscript>
    </div>
</f:section>



<f:comment>Image tag css</f:comment>
<f:section name="RenderingCss">
    <bk2k:var name="selector" value="{f:if(condition: '{data.image_cssselector}', then:'{data.image_cssselector}', else:'{imagesize.selector}')}" />
    <f:format.raw value="{selector}" /><f:format.raw>{
        background-repeat:no-repeat;background-position:center center;-webkit-background-size: cover;-moz-background-size: cover;-o-background-size: cover;background-size: cover;
        -ms-filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='</f:format.raw>{f:uri.image(image: file.0, width: '{imagesize.lg.width}{imagesize.lg.cropwidth}', height: '{imagesize.lg.height}{imagesize.lg.cropheight}', absolute: settings.absoluteUrl)}<f:format.raw>',sizingMethod='scale')";
    }</f:format.raw>
    <bk2k:mediaQuery min="lg"><f:format.raw value="{selector}" /><f:format.raw>{background-image:url("</f:format.raw>{f:uri.image(image: file.0, width: '{imagesize.lg.width}{imagesize.lg.cropwidth}', height: '{imagesize.lg.height}{imagesize.lg.cropheight}',  absolute: '{settings.absoluteUrl}')}<f:format.raw>");}</f:format.raw></bk2k:mediaQuery>
    <bk2k:mediaQuery min="md" max="lg"><f:format.raw value="{selector}" /><f:format.raw>{background-image:url("</f:format.raw>{f:uri.image(image: file.1, width: '{imagesize.md.width}{imagesize.md.cropwidth}', height: '{imagesize.md.height}{imagesize.md.cropheight}',  absolute: '{settings.absoluteUrl}')}<f:format.raw>");}</f:format.raw></bk2k:mediaQuery>
    <bk2k:mediaQuery min="sm" max="md"><f:format.raw value="{selector}" /><f:format.raw>{background-image:url("</f:format.raw>{f:uri.image(image: file.2, width: '{imagesize.sm.width}{imagesize.sm.cropwidth}', height: '{imagesize.sm.height}{imagesize.sm.cropheight}',  absolute: settings.absoluteUrl)}<f:format.raw>");}</f:format.raw></bk2k:mediaQuery>
    <bk2k:mediaQuery min="xs" max="sm"><f:format.raw value="{selector}" /><f:format.raw>{background-image:url("</f:format.raw>{f:uri.image(image: file.3, width: '{imagesize.xs.width}{imagesize.xs.cropwidth}', height: '{imagesize.xs.height}{imagesize.xs.cropheight}',  absolute: settings.absoluteUrl)}<f:format.raw>");}</f:format.raw></bk2k:mediaQuery>
    <bk2k:mediaQuery max="xs"><f:format.raw value="{selector}" /><f:format.raw>{background-image:url("</f:format.raw>{f:uri.image(image: file.4, width: '{imagesize.xxs.width}{imagesize.xxs.cropwidth}', height: '{imagesize.xxs.height}{imagesize.xxs.cropheight}',  absolute: settings.absoluteUrl)}<f:format.raw>");}</f:format.raw></bk2k:mediaQuery>
</f:section>



<f:comment>Image tag Img with data attributes, this is the compatible old mode working nearly everywhere</f:comment>
<f:section name="RenderingImg">
    <div id="{imagesize.selector}" {f:if(condition: '{settings.images.preventrelayout}', then: 'class="embed-responsive"')}>
        <img
        <f:switch expression="{settings.images.placeholder}">
            <f:case value="1">
                src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
            </f:case>
            <f:case value="2">
                src="{f:uri.image(image: file.0, width: '{imagesize.placeholder.width}{imagesize.lg.cropwidth}', height: '{imagesize.placeholder.height}{imagesize.lg.cropheight}', absolute: '{settings.images.absoluteUrl}')}"
            </f:case>
            <f:case default="TRUE">
                src="{f:uri.image(src: 'EXT:bootstrap_package/Resources/Public/Images/blank.gif')}"
            </f:case>
        </f:switch>
        data-src="{f:uri.image(image: file.0, absolute: '{settings.images.absoluteUrl}')}"
        data-bigger="{f:uri.image(image: file.0, width: '{imagesize.lg.width}{imagesize.lg.cropwidth}', height: '{imagesize.lg.height}{imagesize.lg.cropheight}', absolute: '{settings.images.absoluteUrl}')}"
        data-large="{f:uri.image(image: file.1, width: '{imagesize.md.width}{imagesize.md.cropwidth}', height: '{imagesize.md.height}{imagesize.md.cropheight}', absolute: '{settings.images.absoluteUrl}')}"
        data-medium="{f:uri.image(image: file.2, width: '{imagesize.sm.width}{imagesize.sm.cropwidth}', height: '{imagesize.sm.height}{imagesize.sm.cropheight}', absolute: '{settings.images.absoluteUrl}')}"
        data-small="{f:uri.image(image: file.3, width: '{imagesize.xs.width}{imagesize.xs.cropwidth}', height: '{imagesize.xs.height}{imagesize.xs.cropheight}', absolute: '{settings.images.absoluteUrl}')}"
        data-xsmall="{f:uri.image(image: file.4, width: '{imagesize.xxs.width}{imagesize.xxs.cropwidth}', height: '{imagesize.xxs.height}{imagesize.xxs.cropheight}', absolute: '{settings.images.absoluteUrl}')}"
        title="{file.0.title}"
        alt="{file.0.alternative}"
        class="lazyload"
        data-preload="{f:if(condition: settings.media.preload, then: 'true', else: 'false')}"
        />
        <noscript>
            <img src="{f:uri.image(image: file.0, absolute: '{settings.images.absoluteUrl}')}" title="{file.0.title}" alt="{file.0.alternative}" />
        </noscript>
    </div>
</f:section>



<f:comment>Video tag</f:comment>
<f:section name="RenderingVideo">
    <f:media
    class="embed-responsive-item"
    file="{file}"
    alt="{file.alternative}"
    title="{file.title}"
    />
</f:section>



<f:comment>Fallback tag</f:comment>
<f:section name="RenderingFallback">
    <f:media file="{file}" title="{file.title}" width="{imagesize.lg.width}{imagesize.lg.cropwidth}" height="{imagesize.lg.height}{imagesize.lg.cropheight}" alt="{file.alternative}" />
</f:section>
