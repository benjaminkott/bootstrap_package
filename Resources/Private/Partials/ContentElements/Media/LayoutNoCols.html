{namespace bk2k = BK2K\BootstrapPackage\ViewHelpers}
<f:comment>Equal height for each row, flexible width</f:comment>

<bk2k:imagesLayout files="{files}" data="{data}" imagesize="imagesize" as="collection"> 
  
  <f:if condition="{collection.error}">
    <f:render partial="Media/LayoutError" arguments="{error: collection.error}" />
  </f:if> 
  
  <f:switch expression="{data.images_layout}">
    <f:case value="34">
      <bk2k:var name="align" value=" row-flex-left"/>
    </f:case>
    <f:case value="18">
      <bk2k:var name="align" value=" row-flex-right"/>
    </f:case>
    <f:case default="TRUE">
      <bk2k:var name="align" value=""/>
    </f:case>
  </f:switch> 
  <f:if condition="{data.images_layout} == 10">
    <bk2k:css inline="{settings.moveCssToBody}" key="bootstrap_package_row-justify-{data.uid}">
      <bk2k:mediaQuery max="xs">
        <f:for each="{collection.files}" as="file" iteration="fileIteration">
          #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.xxs.percent}%<f:format.raw>;}</f:format.raw>
        </f:for>
      </bk2k:mediaQuery> 
      <bk2k:mediaQuery min="xs" max="sm">
        <f:for each="{collection.files}" as="file" iteration="fileIteration">
          #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.xs.percent}%<f:format.raw>;}</f:format.raw>
        </f:for>
      </bk2k:mediaQuery>
      <bk2k:mediaQuery min="sm" max="md">
        <f:for each="{collection.files}" as="file" iteration="fileIteration">
          #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.sm.percent}%<f:format.raw>;}</f:format.raw>
        </f:for>
      </bk2k:mediaQuery>
      <bk2k:mediaQuery min="md" max="lg">
        <f:for each="{collection.files}" as="file" iteration="fileIteration">
          #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.md.percent}%<f:format.raw>;}</f:format.raw>
        </f:for>
      </bk2k:mediaQuery>
      <bk2k:mediaQuery min="lg">
        <f:for each="{collection.files}" as="file" iteration="fileIteration">
          #col-{data.uid}-{fileIteration.cycle}<f:format.raw>{</f:format.raw>width:{file.size.lg.percent}%<f:format.raw>;}</f:format.raw>
        </f:for>
      </bk2k:mediaQuery>
    </bk2k:css>
  </f:if>
  <div class="table-flex">
  <div class="row-flex{align}">
      <f:for each="{collection.files}" as="file" iteration="fileIteration">
        
          <div id="col-{data.uid}-{fileIteration.cycle}" class="col-flex">
            <f:render partial="Media/Type" arguments="{file: file.srcset, data: data, settings: settings, imagesize: file.size}" />
          </div>
          <f:if condition="{fileIteration.cycle} > 0">
            <f:if condition="{fileIteration.cycle} < {fileIteration.total}">
              <f:if condition="{bk2k:simpleMath(operator: '%', a:'{fileIteration.cycle}', b:'{collection.imagecols}')} == 0">
                </div><div class="row-flex{align}">
              </f:if>
            </f:if>
          </f:if>
      </f:for> 
  </div> 
  </div> 
</bk2k:imagesLayout>
